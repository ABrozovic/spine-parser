{"version":3,"file":"Slot.mjs","sources":["../../src/core/Slot.ts"],"sourcesContent":["import { Color, ISlot } from '@pixi-spine/base';\r\n\r\nimport type { Attachment } from './attachments/Attachment';\r\nimport type { Bone } from './Bone';\r\nimport type { SlotData } from './SlotData';\r\n\r\n/**\r\n * @public\r\n */\r\nexport class Slot implements ISlot {\r\n    blendMode: number;\r\n\r\n    // this is canon\r\n    data: SlotData;\r\n    bone: Bone;\r\n    color: Color;\r\n    darkColor: Color;\r\n    attachment: Attachment;\r\n    private attachmentTime: number;\r\n    attachmentVertices = new Array<number>();\r\n\r\n    constructor(data: SlotData, bone: Bone) {\r\n        if (data == null) throw new Error('data cannot be null.');\r\n        if (bone == null) throw new Error('bone cannot be null.');\r\n        this.data = data;\r\n        this.bone = bone;\r\n        this.color = new Color();\r\n        this.darkColor = data.darkColor == null ? null : new Color();\r\n        this.setToSetupPose();\r\n\r\n        this.blendMode = this.data.blendMode;\r\n    }\r\n\r\n    /** @return May be null. */\r\n    getAttachment(): Attachment {\r\n        return this.attachment;\r\n    }\r\n\r\n    /** Sets the attachment and if it changed, resets {@link #getAttachmentTime()} and clears {@link #getAttachmentVertices()}.\r\n     * @param attachment May be null. */\r\n    setAttachment(attachment: Attachment) {\r\n        if (this.attachment == attachment) return;\r\n        this.attachment = attachment;\r\n        this.attachmentTime = this.bone.skeleton.time;\r\n        this.attachmentVertices.length = 0;\r\n    }\r\n\r\n    setAttachmentTime(time: number) {\r\n        this.attachmentTime = this.bone.skeleton.time - time;\r\n    }\r\n\r\n    /** Returns the time since the attachment was set. */\r\n    getAttachmentTime(): number {\r\n        return this.bone.skeleton.time - this.attachmentTime;\r\n    }\r\n\r\n    setToSetupPose() {\r\n        this.color.setFromColor(this.data.color);\r\n        if (this.darkColor != null) this.darkColor.setFromColor(this.data.darkColor);\r\n        if (this.data.attachmentName == null) this.attachment = null;\r\n        else {\r\n            this.attachment = null;\r\n            this.setAttachment(this.bone.skeleton.getAttachment(this.data.index, this.data.attachmentName));\r\n        }\r\n    }\r\n}\r\n"],"names":[],"mappings":";;AASO,MAAM,IAAsB,CAAA;AAAA,EAY/B,WAAA,CAAY,MAAgB,IAAY,EAAA;AAFxC,IAAA,IAAA,CAAA,kBAAA,GAAqB,IAAI,KAAc,EAAA,CAAA;AAGnC,IAAA,IAAI,IAAQ,IAAA,IAAA;AAAM,MAAM,MAAA,IAAI,MAAM,sBAAsB,CAAA,CAAA;AACxD,IAAA,IAAI,IAAQ,IAAA,IAAA;AAAM,MAAM,MAAA,IAAI,MAAM,sBAAsB,CAAA,CAAA;AACxD,IAAA,IAAA,CAAK,IAAO,GAAA,IAAA,CAAA;AACZ,IAAA,IAAA,CAAK,IAAO,GAAA,IAAA,CAAA;AACZ,IAAK,IAAA,CAAA,KAAA,GAAQ,IAAI,KAAM,EAAA,CAAA;AACvB,IAAA,IAAA,CAAK,YAAY,IAAK,CAAA,SAAA,IAAa,IAAO,GAAA,IAAA,GAAO,IAAI,KAAM,EAAA,CAAA;AAC3D,IAAA,IAAA,CAAK,cAAe,EAAA,CAAA;AAEpB,IAAK,IAAA,CAAA,SAAA,GAAY,KAAK,IAAK,CAAA,SAAA,CAAA;AAAA,GAC/B;AAAA;AAAA,EAGA,aAA4B,GAAA;AACxB,IAAA,OAAO,IAAK,CAAA,UAAA,CAAA;AAAA,GAChB;AAAA;AAAA;AAAA,EAIA,cAAc,UAAwB,EAAA;AAClC,IAAA,IAAI,KAAK,UAAc,IAAA,UAAA;AAAY,MAAA,OAAA;AACnC,IAAA,IAAA,CAAK,UAAa,GAAA,UAAA,CAAA;AAClB,IAAK,IAAA,CAAA,cAAA,GAAiB,IAAK,CAAA,IAAA,CAAK,QAAS,CAAA,IAAA,CAAA;AACzC,IAAA,IAAA,CAAK,mBAAmB,MAAS,GAAA,CAAA,CAAA;AAAA,GACrC;AAAA,EAEA,kBAAkB,IAAc,EAAA;AAC5B,IAAA,IAAA,CAAK,cAAiB,GAAA,IAAA,CAAK,IAAK,CAAA,QAAA,CAAS,IAAO,GAAA,IAAA,CAAA;AAAA,GACpD;AAAA;AAAA,EAGA,iBAA4B,GAAA;AACxB,IAAA,OAAO,IAAK,CAAA,IAAA,CAAK,QAAS,CAAA,IAAA,GAAO,IAAK,CAAA,cAAA,CAAA;AAAA,GAC1C;AAAA,EAEA,cAAiB,GAAA;AACb,IAAA,IAAA,CAAK,KAAM,CAAA,YAAA,CAAa,IAAK,CAAA,IAAA,CAAK,KAAK,CAAA,CAAA;AACvC,IAAA,IAAI,KAAK,SAAa,IAAA,IAAA;AAAM,MAAA,IAAA,CAAK,SAAU,CAAA,YAAA,CAAa,IAAK,CAAA,IAAA,CAAK,SAAS,CAAA,CAAA;AAC3E,IAAI,IAAA,IAAA,CAAK,KAAK,cAAkB,IAAA,IAAA;AAAM,MAAA,IAAA,CAAK,UAAa,GAAA,IAAA,CAAA;AAAA,SACnD;AACD,MAAA,IAAA,CAAK,UAAa,GAAA,IAAA,CAAA;AAClB,MAAK,IAAA,CAAA,aAAA,CAAc,IAAK,CAAA,IAAA,CAAK,QAAS,CAAA,aAAA,CAAc,IAAK,CAAA,IAAA,CAAK,KAAO,EAAA,IAAA,CAAK,IAAK,CAAA,cAAc,CAAC,CAAA,CAAA;AAAA,KAClG;AAAA,GACJ;AACJ;;;;"}